import{r as a,a as C}from"./vendor-SIwY82C9.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerPolicy&&(l.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?l.credentials="include":t.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(t){if(t.ep)return;t.ep=!0;const l=n(t);fetch(t.href,l)}})();var m={exports:{}},x={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S=a,w=Symbol.for("react.element"),R=Symbol.for("react.fragment"),v=Object.prototype.hasOwnProperty,P=S.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,A={key:!0,ref:!0,__self:!0,__source:!0};function f(r,o,n){var s,t={},l=null,i=null;n!==void 0&&(l=""+n),o.key!==void 0&&(l=""+o.key),o.ref!==void 0&&(i=o.ref);for(s in o)v.call(o,s)&&!A.hasOwnProperty(s)&&(t[s]=o[s]);if(r&&r.defaultProps)for(s in o=r.defaultProps,o)t[s]===void 0&&(t[s]=o[s]);return{$$typeof:w,type:r,key:l,ref:i,props:t,_owner:P.current}}x.Fragment=R;x.jsx=f;x.jsxs=f;m.exports=x;var e=m.exports,y,g=C;y=g.createRoot,g.hydrateRoot;const b=a.createContext(),T={status:"idle",error:null,result:null,raw:null};function k(r,o){switch(o.type){case"SUBMIT_START":return{...r,status:"submitting",error:null};case"SUBMIT_SUCCESS":return{...r,status:"success",result:o.payload.normalized,raw:o.payload.raw};case"SUBMIT_ERROR":return{...r,status:"error",error:o.payload};default:return r}}function _({children:r,initialState:o}){const[n,s]=a.useReducer(k,o||T);return e.jsx(b.Provider,{value:{state:n,dispatch:s},children:r})}function j(){const r=a.useContext(b);if(!r)throw new Error("useCalculation must be used within CalculationProvider");return r}async function B({file:r,taxYear:o,analysisType:n}){const s=window.location.origin+"/prod",t=new FormData;t.append("file",r),t.append("tax_year",o),t.append("analysis_type",n);const l=await fetch(s+"/calculate",{method:"POST",body:t});if(!l.ok){let u="HTTP "+l.status;try{const c=await l.json();c.error&&(u=c.error)}catch{}throw new Error(u)}return{raw:await l.json()}}function E(){console.log("[CalculatorPage] Rendering component");const{state:r,dispatch:o}=j(),[n,s]=a.useState(null),[t,l]=a.useState("2024-2025"),[i,u]=a.useState("both"),c=async d=>{if(d.preventDefault(),!!n){o({type:"SUBMIT_START"});try{const{raw:p}=await B({file:n,taxYear:t,analysisType:i});o({type:"SUBMIT_SUCCESS",payload:{raw:p,normalized:p}}),window.location.hash="#results"}catch(p){o({type:"SUBMIT_ERROR",payload:p.message})}}};return console.log("[CalculatorPage] State:",r,"File:",n),e.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, Arial",border:"2px solid blue",margin:"10px",backgroundColor:"#f8f9fa"},children:[e.jsx("h2",{style:{color:"blue",marginBottom:"1rem"},children:"ðŸ§® React Calculator (Modern SPA)"}),e.jsxs("p",{style:{marginBottom:"1rem",fontSize:"14px",color:"#666"},children:["Status: ",e.jsx("strong",{children:r.status})," | File: ",e.jsx("strong",{children:(n==null?void 0:n.name)||"None selected"})]}),e.jsxs("form",{onSubmit:c,style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"ðŸ“ Select File (CSV or QFX):"}),e.jsx("input",{type:"file",accept:".csv,.qfx,.ofx",onChange:d=>s(d.target.files[0]||null),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"4px",width:"100%",fontSize:"14px"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"ðŸ“… Tax Year:"}),e.jsx("select",{value:t,onChange:d=>l(d.target.value),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:["2024-2025","2023-2024","2022-2023","2021-2022"].map(d=>e.jsx("option",{children:d},d))})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"ðŸ“Š Analysis Type:"}),e.jsxs("select",{value:i,onChange:d=>u(d.target.value),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:[e.jsx("option",{value:"both",children:"Tax & Portfolio Analysis"}),e.jsx("option",{value:"tax",children:"Tax Analysis Only"}),e.jsx("option",{value:"portfolio",children:"Portfolio Analysis Only"})]})]}),e.jsx("button",{type:"submit",disabled:r.status==="submitting"||!n,style:{padding:"1rem 2rem",fontSize:"16px",fontWeight:"bold",backgroundColor:n?"#007acc":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:n?"pointer":"not-allowed",transition:"all 0.2s"},children:r.status==="submitting"?"â³ Calculatingâ€¦":"ðŸš€ Calculate Tax & Portfolio"})]}),r.error&&e.jsxs("div",{style:{backgroundColor:"#ffe6e6",border:"2px solid #ff4444",padding:"1rem",borderRadius:"8px",marginTop:"1rem"},children:[e.jsx("strong",{children:"âŒ Error:"})," ",r.error]}),r.status==="success"&&e.jsxs("div",{style:{backgroundColor:"#e6ffe6",border:"2px solid #44ff44",padding:"1rem",borderRadius:"8px",marginTop:"1rem"},children:[e.jsx("strong",{children:"âœ… Success!"})," Your tax calculation is complete.",e.jsx("button",{onClick:()=>window.location.hash="#results",style:{marginLeft:"1rem",padding:"0.5rem 1rem",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"ðŸ“Š View Results"})]}),e.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",color:"#666"},children:[e.jsx("strong",{children:"â„¹ï¸ About This Version:"}),e.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[e.jsx("li",{children:"Modern React SPA implementation"}),e.jsx("li",{children:"Enhanced user interface with real-time feedback"}),e.jsx("li",{children:"Same powerful UK tax calculation engine"}),e.jsx("li",{children:"Compatible with IBKR QFX and CSV files"})]})]})]})}function O(){console.log("[ResultsPage] Rendering component");const{state:r}=j(),o=a.useMemo(()=>{var t,l;const n=((l=(t=r.raw)==null?void 0:t.portfolio_analysis)==null?void 0:l.market_summaries)||{};let s=[];return Object.values(n).forEach(i=>{Array.isArray(i.holdings)&&(s=s.concat(i.holdings))}),s},[r.raw]);return console.log("[ResultsPage] State:",r.status,"Holdings:",o.length),r.status!=="success"?e.jsxs("div",{style:{padding:"2rem",border:"2px solid orange",margin:"10px",backgroundColor:"#fff9e6",textAlign:"center"},children:[e.jsx("h2",{style:{color:"orange"},children:"ðŸ“Š Results Page"}),e.jsxs("p",{style:{fontSize:"18px",margin:"1rem 0"},children:[r.status==="idle"&&"ðŸ”„ No calculation performed yet",r.status==="submitting"&&"â³ Calculation in progress...",r.status==="error"&&`âŒ Error: ${r.error}`]}),e.jsx("button",{onClick:()=>window.location.hash="",style:{padding:"1rem 2rem",backgroundColor:"#007acc",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px"},children:"ðŸ§® Go to Calculator"})]}):e.jsxs("div",{style:{padding:"2rem",border:"3px solid green",margin:"10px",backgroundColor:"#f0fff0",minHeight:"80vh"},children:[e.jsx("div",{style:{backgroundColor:"#4CAF50",color:"white",padding:"1rem",borderRadius:"8px",textAlign:"center",marginBottom:"2rem"},children:e.jsx("h1",{style:{margin:0},children:"ðŸ“Š Tax Calculation Results"})}),e.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",marginBottom:"2rem"},children:[e.jsx("h2",{style:{color:"#4CAF50"},children:"ðŸ“ˆ Portfolio Summary"}),e.jsxs("p",{style:{fontSize:"18px",fontWeight:"bold"},children:["Total Holdings: ",e.jsx("span",{style:{color:"#4CAF50"},children:o.length})]})]}),o.length>0&&e.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#4CAF50",marginBottom:"1rem"},children:"ðŸ¢ Holdings Details (First 10)"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#4CAF50",color:"white"},children:[e.jsx("th",{style:{padding:"12px",border:"1px solid #ddd"},children:"Symbol"}),e.jsx("th",{style:{padding:"12px",border:"1px solid #ddd"},children:"Quantity"}),e.jsx("th",{style:{padding:"12px",border:"1px solid #ddd"},children:"Price"}),e.jsx("th",{style:{padding:"12px",border:"1px solid #ddd"},children:"Market Value"})]})}),e.jsx("tbody",{children:o.slice(0,10).map((n,s)=>e.jsxs("tr",{style:{backgroundColor:s%2===0?"#f9f9f9":"white","&:hover":{backgroundColor:"#e8f5e8"}},children:[e.jsx("td",{style:{padding:"10px",border:"1px solid #ddd",fontWeight:"bold",color:"#4CAF50"},children:n.symbol||"--"}),e.jsx("td",{style:{padding:"10px",border:"1px solid #ddd"},children:n.quantity||0}),e.jsxs("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["$",n.price||0]}),e.jsxs("td",{style:{padding:"10px",border:"1px solid #ddd",fontWeight:"bold"},children:["$",n.market_value||0]})]},s))})]})})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"2rem"},children:e.jsx("button",{onClick:()=>window.location.hash="",style:{padding:"1rem 2rem",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"ðŸ§® New Calculation"})})]})}function F(){console.log("[SPA] App component rendering...");const r=typeof window<"u"?window.location.hash:"",o=r.startsWith("#results");return console.log("[SPA] Current hash:",r,"isResults:",o),e.jsx(_,{children:e.jsxs("div",{style:{padding:"20px",border:"2px solid green",margin:"10px"},children:[e.jsx("h1",{style:{color:"green"},children:"ðŸš€ React SPA Loaded Successfully!"}),e.jsxs("p",{children:["Current URL hash: ",e.jsx("code",{children:r||"(none)"})]}),e.jsxs("p",{children:["Showing: ",o?"Results Page":"Calculator Page"]}),o?e.jsx(O,{}):e.jsx(E,{})]})})}console.log("[SPA] Starting React application...");const h=document.getElementById("spa-root");console.log("[SPA] Container found:",h);if(h){console.log("[SPA] Creating React root...");const r=y(h);console.log("[SPA] Rendering App component..."),r.render(e.jsx(F,{})),console.log("[SPA] React app rendered successfully")}else{console.error("[SPA] Mount container #spa-root not found!");const r=document.createElement("div");r.id="spa-root",r.innerHTML='<p style="color: red; padding: 20px;">SPA container not found - created fallback</p>',document.body.appendChild(r)}
